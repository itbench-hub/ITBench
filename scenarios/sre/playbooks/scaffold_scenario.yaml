---
- name: Scaffold New Scenario
  hosts: localhost
  connection: local
  gather_facts: false
  pre_tasks:
    - name: Import applications role
      ansible.builtin.include_role:
        name: applications
        tasks_from: load_defaults
  tasks:
    - name: Collect scenario inputs
      ansible.builtin.include_role:
        name: scaffolding
        tasks_from: collect_scenario_inputs

    - name: Collect scenario tags
      ansible.builtin.include_role:
        name: scaffolding
        tasks_from: collect_scenario_tags

    - name: Select fault for scenario
      ansible.builtin.include_role:
        name: scaffolding
        tasks_from: select_fault

    - name: Write scenario artifacts
      ansible.builtin.include_role:
        name: scaffolding
        tasks_from: write_scenario_artifacts
      vars:
        scaffolding_fault_id: "{{ scaffolding_selected_fault_id }}"
        scaffolding_tags: "{{ scaffolding_scenario_tags }}"

    - name: Generate new scenario files
      ansible.builtin.include_role:
        name: scaffolding
        tasks_from: generate_new_scenario_files
